ind <- sub(p, "X", x)
ind
p <- "[^(a-zAz0-9\\s)]"
ind <- sub(p, "X", x)
ind
p <- "[^a-zAz|0-9\\s]"
ind <- sub(p, "X", x)
ind
p <- "[^a-zAz|0-9|\\s]"
ind <- sub(p, "X", x)
ind
p <- "[^a-zAz0-9\\s]"
ind <- sub(p, "X", x)
ind
p <- "[^[:alnum:] ]"
ind <- sub(p, "X", x)
ind
p <- "[^[:alnum:]]"
ind <- sub(p, "X", x[1])
ind
p <- "[^[:alpha:]]"
ind <- sub(p, "X", x[1])
ind
p <- "[^[:alpha:]\\.]"
ind <- sub(p, "X", x[1])
ind
p <- "[^[:alpha:] ]"
ind <- sub(p, "X", x[1])
ind
ind <- gsub(p, "X", x[1])
ind
p <- "[^[:alpha:]]"
ind <- gsub(p, "X", x[1])
ind
p <- "[^[:alnum:] ]"
ind <- gsub(p, "X", x[1])
ind
p <- "[^[:alnum:] ]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]][:num:]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:] ][:num:]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]][0-9]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]][0-9][^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]][0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]]{0,}[0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:\\s]]{0,}[0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:\\s]]{1,}[0-9]{1,}[^[:alnum:]]{0,}"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:\\s]]{1,}[0-9]{1,}[^[:alnum:]]{1,}"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:\\s]]{1,}[0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:alnum:]][0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
x
p <- "[^[:num:]][0-9]{1,}[^[:alnum:]]"
ind <- gsub(p, "X", x)
ind
p <- "[^[:num:]][0-9]{1,}[^[:alnum:]]{1,}"
ind <- gsub(p, "X", x)
ind
p <- "[^[:num:]][0-9]{1,}[^[:alnum:]]{0,}"
ind <- gsub(p, "X", x)
ind
p <- "[^[:num:]][0-9]{1,}[^[:alnum:]]{0,}"
ind <- gsub(p, "", x)
ind
"[^[:alnum:]][0-9]"
ind <- gsub(p, "", x)
ind
"[0-9]{1,}[^[:num:]][0-9]{1,}"
ind <- gsub(p, "", x)
ind
"[0-9]{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "(\\d{1,}\\s\\d{1,})" ## matches space surrounded by one or more numbers
ind <- gsub(p, "", x)
ind
p <- "[0-9]{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "[0-9]{1,}[^0-9][0-9]{1,} | [0-9]{5,}"
ind <- gsub(p, "", x)
ind
p <- "[0-9]{1,}[^0-9][0-9]{1,} & [0-9]{5,}"
ind <- gsub(p, "", x)
ind
p <- "[0-9]{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "[[:alnum:]]{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "[[:num:]]{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "\\S{1,}[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
x
p <- "[^0-9][0-9]{1,}"
ind <- gsub(p, "", x)
ind
p <- "[^0-9][0-9]{1,}[^[:alnum:] ]"
ind <- gsub(p, "", x)
ind
p <- "[:num:]"
ind <- gsub(p, "", x)
ind
p <- "[0-9]"
ind <- gsub(p, "", x)
ind
p <- "\\S{1,}[0-9]{1,}\\S{1,}"
ind <- gsub(p, "", x)
ind
p <- "(\\S{1,}[0-9]{1,}\\S{1,}){1,}"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]){1,}"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]){3,}"
ind <- gsub(p, "", x)
ind
xdf
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]){4,}"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]{4,})"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]{3,})"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]]{2,})"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[^[:alnum:]])"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,}[[:alnum:]])"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([^[:num:]]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([^[0-9]]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([[^0-9]]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([^0-9]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([^0-9]{1,}[0-9]{1,}[^[:alnum:]])"
ind <- gsub(p, "", x)
ind
p <- "([^0-9]{1,}[0-9]{1,})"
ind <- gsub(p, "", x)
ind
p <- "([^0-9]{1,}[0-9]{1,}[^0-9])"
ind <- gsub(p, "", x)
ind
source('~/MEGA/textPredictApp/shiny_predictorMAT.R')
gc()
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the united states of")
proc.time() - ptm
shiny::runApp()
runApp()
head(pred1)
x -> "a"
x <- "a"
x  <- tolower(x)
x  <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", x, perl=TRUE)
x  <- unlist(strsplit(x, " "))
wc <- length(x)
x
x1 <- fixedPaste(x[wc])
x1
ph_index <- which(pred1$phraseId == x1)    ## this one is 30% faster
ph_index
w1_index <- unlist(pred1[ph_index, 2:np])
w1_index
w_index  <- unique(c(w_index, w1_index))
w_index  <- w_index[which(!is.na(w_index))]
prediction <- as.character(wcode$word[w_index])
prediction
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
source('~/MEGA/textPredictApp/shiny_predictor.R')
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("I")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
predict.next.word <- function (x) {
x  <- tolower(x)
x  <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", x, perl=TRUE)
x  <- unlist(strsplit(x, " "))
wc <- length(x)
if (wc > 3){
x4 <- x[(wc-3):(wc)]
ph_code  <- unlist(sapply(1:4, find.codes4, x4 = x4))
ph_code  <- paste((ph_code + 1000), collapse = "")
ph_code  <- as.numeric(ph_code)
ph_index <- which(pred4$phraseCode == ph_code)
w_index  <- unlist(pred4[ph_index, 2:np])
w_index  <- w_index[which(!is.na(w_index))]
}
if (wc > 2 & length(w_index) < numPreds){
x3 <- x[(wc-2):(wc)]
ph_code  <- unlist(sapply(1:3, find.codes3, x3 = x3))
ph_code  <- paste((ph_code + 10000), collapse = "")
ph_code  <- as.numeric(ph_code)
ph_index <- which(pred3$phraseCode == ph_code)
w3_index <- unlist(pred3[ph_index, 2:np])
w_index  <- unique(c(w_index, w3_index))
w_index  <- w_index[which(!is.na(w_index))]
}
if (wc > 1 & length(w_index) < numPreds){
x2 <- x[(wc-1):(wc)]
ph_code  <- unlist(sapply(1:2, find.codes2, x2 = x2))
ph_code  <- paste((ph_code + 10000), collapse = "")
ph_code  <- as.numeric(ph_code)
ph_index <- which(pred2$phraseCode == ph_code)
w2_index <- unlist(pred2[ph_index, 2:np])
w_index  <- unique(c(w_index, w2_index))
w_index  <- w_index[which(!is.na(w_index))]
}
if (length(w_index) < numPreds){
x1 <- fixedPaste(x[wc])
#ph_index <- which(pred1$phraseId == x1)    ## this one is 30% faster
ph_index <- grep(x1, pred1$phraseId, fixed = TRUE, useBytes = TRUE)
w1_index <- unlist(pred1[ph_index, 2:np])
w_index  <- unique(c(w_index, w1_index))
w_index  <- w_index[which(!is.na(w_index))]
}
if (length(w_index) < numPreds) {
w_index <- unique(c(w_index, back_off))
}
w_index <- w_index[1:numPreds]
prediction <- as.character(wcode$word[w_index])
return(prediction)
}
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("the")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
ptm <- proc.time()
predict.next.word("a")
proc.time() - ptm
gc()
w1_index <- unlist(pred1[ph_index, 2:np])
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
